{"version":3,"sources":["assets/img/Legend.png","assets/svg/legendIcons/battle.svg","assets/svg/legendIcons/troopMovement.svg","assets/svg/legendIcons/osada.svg","assets/svg/legendIcons/city.svg","assets/svg/legendIcons/dote.svg","assets/svg/legendIcons/dogovor.svg","assets/svg/search.svg","redux/map/actions.js","utils/constants.js","components/Legend/Legend.jsx","components/Legend/Legend.index.js","utils/utils.js","utils/arrows/leaflet-thickarrows-draw.js","utils/arrows/leaflet-thickarrows.js","components/Map/Map.jsx","components/Map/Map.index.js","components/Search/Search.jsx","components/Search/Search,index.js","components/YearsNavigation/YearsNavigation.jsx","components/YearsNavigation/YearsNavigation.index.js","components/Infoblock/BattleOsada/BattleOsada.jsx","components/Infoblock/BattleOsada/BattleOsada.index.js","components/Infoblock/Html/Html.jsx","components/Infoblock/Html/Html.index.js","components/Infoblock/InfoblockToggler.jsx","components/Infoblock/Infoblock.jsx","components/Infoblock/Infoblock.index.js","pages/MapPage/MapPage.jsx","pages/MapPage/MapPage.index.js","App.js","redux/map/reducer.js","redux/rootReducer.js","utils/requests/map.api.js","redux/map/saga.js","redux/sagas.js","redux/configureStore.js","index.js","assets/img/ArrowLeft.png","assets/img/ArrowRight.png"],"names":["module","exports","initMap","payload","type","setSearch","setShowSearch","getThemes","setActiveTheme","getEvents","setActiveEvent","setThemesLoading","setCurrentYear","setMapPosition","setMapZoom","exludeLegendType","setInfoblocks","setInfoblockId","closeInfoblock","clearInfoblockData","getCities","getDotes","getBorders","outcomeTypes","title","value","eventIcons","osada","battle","troopMovement","city","dote","dogovor","Legend","connect","state","legend","map","activeTheme","excludedTypes","dispatch","bindActionCreators","useState","open","setOpen","className","length","src","LegendImg","legendGroup","name","style","visibility","items","item","fill","includes","iconColor","iconType","beforeInjection","svg","classList","add","setAttribute","onClick","checked","onChange","ArrowRight","ArrowLeft","getYearsArray","yearStart","yearEnd","Array","from","_","i","getEventIconSize","zoom","LeafletThickArrowsDraw","options","this","precision","Object","assign","arrow","head","yawn","size","weight","tailWidth","headWidth","parts","layers","kilometersPerPixel","getKilometersPerPixel","forEach","path","index","latLngPath","point","push","layerPointToLatLng","calcArrowBody","angle","up","down","calcHatPoints","hatPoints","leftWingPoint","rightWingPoint","hatCross","L","polyline","lat","lng","upIntersect","turf","toGeoJSON","downIntersect","filterPointsInHat","reverse","prototype","concat","polygon","tip","sizePixels","bearing","thetaLeft","Math","PI","thetaRight","dxLeft","sin","dyLeft","cos","dxRight","dyRight","derivedXY","latLngToLayerPoint","leftWingXY","x","y","rightWingXY","latLng","Util","formatNum","line","intersect","toLatLng","geometry","coordinates","latDirection","sign","lngDirection","filter","abs","getCenter","pow","getZoom","original","prev","current","deltaX","deltaY","newLatLng","Point","width","widthStep","distance","GeometryUtil","upPoint","destination","saved_Polyline_addTo","Polyline","addTo","saved_Polyline__update","_update","saved_Polyline_remove","remove","include","thickArrows","noClip","_thickArrowsDraw","drawThickArrows","_thickArrows","draw","_map","_parts","layerGroup","getThickArrows","console","log","deleteThickArrows","apply","arguments","addLayer","saved_LayerGroup_removeLayer","LayerGroup","removeLayer","saved_LayerGroup_onRemove","onRemove","layer","id","_layers","getLayerId","saved_Map_removeLayer","Map","saved_GeoJSON_geometryToLayer","GeoJSON","geometryToLayer","geojson","figure","addData","len","feature","features","isArray","geometries","asFeature","defaultOptions","resetStyle","onEachFeature","events","mapPosition","mapZoom","cities","dotes","borders","infoblockId","currentYear","setZoom","useEffect","position","showMove","setShowMove","crs","CRS","EPSG3857","maxBoundsViscosity","worldCopyJump","maxBounds","scrollWheelZoom","center","maxZoom","minZoom","zoomAnimation","animate","onzoomend","e","target","_zoom","onclick","latlng","TileLayer","pane","noWrap","tms","url","minShowZoom","iconPerson","Icon","iconUrl","iconRetinaUrl","iconSize","Marker","key","_id","icon","Tooltip","permanent","direction","border","legendType","Component","stripe","GeoJSONFillable","styles","fillPattern","Patterns","StripePattern","spaceWeight","height","color","fillColor","spaceOpacity","spaceColor","stripeColor","undefined","renderer","padding","smoothFactor","opacity","fillOpacity","data","imageUrl","bounds","ImageOverlay","el","isCurrentEvent","cls","join","zIndex","zIndexOffset","Search","search","loading","themesLoading","showSearch","history","useHistory","getData","useDebouncedCallback","SearchImg","placeholder","callback","params","URLSearchParams","append","toString","onSelectTheme","YearsNavigation","scrollBlock","useRef","containerWidth","setConteinerWidth","itemWidth","setItemWidth","itemsCount","setItemsCount","years","setYears","setWindowWidth","handleResize","window","innerWidth","addEventListener","removeEventListener","themeId","clientWidth","Date","getFullYear","timeoutId","setTimeout","onScroll","clearTimeout","scrollLeft","scroll","arrowLeft","ref","year","idx","minWidth","onSetCurrentYear","arrowRight","BattleOsada","infoblocks","f","s","getOutcomeColor","outcomeType","isAllyExists","allyName","date","opponentImgUrl","opponentName","allyImgUrl","commanderImgUrl","commanderName","strength","losses","outcome","find","Html","dangerouslySetInnerHTML","__html","infoblockToggler","html","Infoblock","activeEvent","infoblocksIds","stopPropagation","prevId","MapPage","location","useLocation","vh","innerHeight","document","documentElement","setProperty","queryString","parse","animateScroll","scrollTo","App","baseState","rootReducer","combineReducers","action","axios","get","getThemeById","getDotesRequest","getThemesSaga","getEventsSaga","getCitiesSaga","getDotesSaga","getBordersSaga","initMapSaga","put","call","response","error","takeLatest","takeLeading","rootSaga","all","sagaWiddleware","createSagaMiddleware","store","createStore","compose","applyMiddleware","run","createBrowserHistory","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.522a34e9.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAVCAYAAACg/AXsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIISURBVHgBrVM7UgJBEN0PB8DMBFiLxExifq4nEE8AZBohJwBOgGZm7t5AT8DyqyIkNFwg0YycAnxv6ClXZDeyq7pmu6f7zes3s6ZxZK7rpne7XWu/37sIC/A0fA2fw/3NZhPMZrMw2mNGg2q1yuauNMZZCO+Nx2NPJ6wIQAcATwTAGsBvbNs+Q7HJFfk75rE68FfW/2JSqVQa3JBcM3rKsZVKpUfLsvqq2TQbo9HIN6GBs91uBzwBWrSn0ynZGOVy2UVRC+6AATXxNXgEaA2WF3Ymk6khaJAqAB70aFjYcAk/lxFqjuMYi8ViuFqtZrlczuU+CHxRk7pQe9ajibhrMsNtXHBExszL6DRfiWpZtynjcI0GaAVcUXgLQH5yNE8aPIyQlhHI3GM9WHDPIRN1nUEQrIWRilEwjwoqN0O7kvpQYgWimovFYk6SC6FZi4KkUqlrAQulviBbIcfhiS78hjRR5IFNHd7B/NRhDsBr0YlMfRm/oEEtiPcuSSXwZDLhQ+vJKX00DTQA85E31NGgdj6f/8DmPeJLfYXL5TLIZrND0esThQRu4wAFIE+A44YAbaprOHqFXbzCnhFj8nt0JbwDyJvNLz4enIx+06U+mlESAEcDsxclhS6QEWKBTgBoNj8gSUBJAEoC44Th5+vyiiUMjMMTOAnwh0kMIycJIBbkGCgJ4N/sG3xZSCeMNQuTAAAAAElFTkSuQmCC\"","module.exports = __webpack_public_path__ + \"static/media/battle.a3fda52f.svg\";","module.exports = __webpack_public_path__ + \"static/media/troopMovement.d648020d.svg\";","module.exports = __webpack_public_path__ + \"static/media/osada.52c7ca34.svg\";","module.exports = __webpack_public_path__ + \"static/media/city.d89c57c7.svg\";","module.exports = __webpack_public_path__ + \"static/media/dote.9781b350.svg\";","module.exports = __webpack_public_path__ + \"static/media/dogovor.bbf1c3a4.svg\";","module.exports = __webpack_public_path__ + \"static/media/search.aa9ec654.svg\";","export const INIT_MAP = 'INIT_MAP';\r\n\r\nexport const SET_SEARCH = 'SEARCH/SET_SEARCH';\r\nexport const SET_SHOW_SEARCH = 'SET_SHOW_SEARCH';\r\n\r\nexport const GET_THEMES = 'GET_THEMES';\r\nexport const SET_THEMES = 'SET_THEMES'; \r\nexport const SET_THEMES_LOADING = 'SET_THEMES_LOADING';\r\nexport const SET_ACTIVE_THEME = 'SET_ACTIVE_THEME';\r\n\r\nexport const GET_EVENTS = 'GET_EVENTS';\r\nexport const SET_EVENTS = 'SET_EVENTS';\r\nexport const SET_ACTIVE_EVENT = 'SET_ACTIVE_EVENT';\r\n\r\nexport const SET_INFOBLOCKS = 'SET_INFOBLOCKS';\r\nexport const SET_INFOBLOCK_ID = 'SET_INFOBLOCK_ID';\r\nexport const CLOSE_INFOBLOCK = 'CLOSE_INFOBLOCK';\r\nexport const CLEAR_INFOBLOCK_DATA = 'CLEAR_INFOBLOCK_DATA';\r\n\r\nexport const SET_CURRENT_YEAR = 'SET_CURRENT_YEAR';\r\n\r\nexport const SET_MAP_POSITION = 'SET_MAP_POSITION';\r\nexport const SET_MAP_ZOOM = 'SET_MAP_ZOOM';\r\n\r\nexport const LEGEND_EXLUDE_TYPE = 'LEGEND_EXLUDE_TYPE';\r\n\r\nexport const GET_CITIES = 'GET_CITIES';\r\nexport const SET_CITIES = 'SET_CITIES';\r\n\r\nexport const GET_DOTES = 'GET_DOTES';\r\nexport const SET_DOTES = 'SET_DOTES';\r\n\r\nexport const GET_BORDERS = 'GET_BORDERS';\r\nexport const SET_BORDERS = 'SET_BORDERS';\r\n\r\n/**\r\n * init map data\r\n * @param {} payload init props\r\n */\r\nexport const initMap = payload => ({\r\n  type: INIT_MAP,\r\n  payload\r\n})\r\n\r\n/**\r\n * @param {string} payload \r\n */\r\nexport const setSearch = (payload) => ({\r\n  type: SET_SEARCH,\r\n  payload\r\n})\r\n\r\n/**\r\n * set is show search result\r\n * @param {boolean} payload \r\n */\r\nexport const setShowSearch = (payload) => ({\r\n  type: SET_SHOW_SEARCH,\r\n  payload\r\n})\r\n\r\n/**\r\n * get themes by search\r\n * @param {string} payload search string\r\n */\r\nexport const getThemes = (payload) => ({\r\n  type: GET_THEMES,\r\n  payload\r\n})\r\n\r\n/**\r\n * set themes to redux\r\n * @param {themes[]} payload \r\n */\r\nexport const setThemes = (payload) => ({\r\n  type: SET_THEMES,\r\n  payload\r\n})\r\n\r\n/**\r\n * set active theme\r\n * @param {theme object} payload \r\n */\r\nexport const setActiveTheme = (payload) => ({\r\n  type: SET_ACTIVE_THEME,\r\n  payload\r\n})\r\n\r\n/**\r\n * get events by theme id & currentYear\r\n * @param {{themeId: string, currentYear: number}} payload \r\n */\r\nexport const getEvents = (payload) => ({\r\n  type: GET_EVENTS, \r\n  payload\r\n})\r\n\r\n/**\r\n * set events array to redux\r\n * @param {events[]} payload themes array\r\n */\r\nexport const setEvents = (payload) => ({\r\n  type: SET_EVENTS,\r\n  payload\r\n})\r\n\r\n/**\r\n * set active event\r\n * @param {event object} payload event\r\n */\r\nexport const setActiveEvent = payload => ({\r\n  type: SET_ACTIVE_EVENT,\r\n  payload\r\n})\r\n\r\n/**\r\n * set themes loading\r\n * @param {boolean} payload \r\n */\r\nexport const setThemesLoading = (payload) => ({\r\n  type: SET_THEMES_LOADING,\r\n  payload\r\n})\r\n\r\n/**\r\n * set current year\r\n * @param {number} payload year \r\n */\r\nexport const setCurrentYear = payload => ({\r\n  type: SET_CURRENT_YEAR,\r\n  payload\r\n})\r\n\r\n/**\r\n * set map position\r\n * @param {[point, point]} payload number array\r\n */\r\nexport const setMapPosition = payload => ({\r\n  type: SET_MAP_POSITION,\r\n  payload\r\n})\r\n\r\n/**\r\n * set map zoom level\r\n * @param {number} payload zoom\r\n */\r\nexport const setMapZoom = payload => ({\r\n  type: SET_MAP_ZOOM,\r\n  payload\r\n})\r\n\r\n/**\r\n * add or remove in exluded types\r\n * @param {string} payload type\r\n */\r\nexport const exludeLegendType = payload => ({\r\n  type: LEGEND_EXLUDE_TYPE,\r\n  payload\r\n})\r\n\r\n/**\r\n * add infoblock to array\r\n * @param {infoblock object} payload \r\n */\r\nexport const setInfoblocks = payload => ({\r\n  type: SET_INFOBLOCKS,\r\n  payload\r\n})\r\n\r\n/**\r\n * set active infoblock id\r\n * @param {string} payload object id\r\n */\r\nexport const setInfoblockId = payload => ({\r\n  type: SET_INFOBLOCK_ID,\r\n  payload\r\n})\r\n\r\n/**\r\n * close tab\r\n * @param {string} payload infoblock id\r\n */\r\nexport const closeInfoblock = payload => ({\r\n  type: CLOSE_INFOBLOCK,\r\n  payload\r\n})\r\n\r\nexport const clearInfoblockData = () => ({\r\n  type: CLEAR_INFOBLOCK_DATA\r\n})\r\n\r\n\r\n\r\n/**\r\n * get cities by year\r\n * @param {year} payload \r\n */\r\nexport const getCities = payload => ({\r\n  type: GET_CITIES,\r\n  payload\r\n})\r\n\r\n/**\r\n * set cities to redux\r\n * @param {cities} payload \r\n */\r\nexport const setCities = payload => ({\r\n  type: SET_CITIES,\r\n  payload\r\n})\r\n\r\n\r\nexport const getDotes = () => ({\r\n  type: GET_DOTES\r\n})\r\n\r\nexport const setDotes = payload => ({\r\n  type: SET_DOTES,\r\n  payload\r\n})\r\n\r\n\r\n/**\r\n * get borders by year\r\n * @param {year} payload \r\n */\r\n export const getBorders = payload => ({\r\n  type: GET_BORDERS,\r\n  payload\r\n})\r\n\r\n/**\r\n * set borders to redux\r\n * @param {borders} payload \r\n */\r\nexport const setBorders = payload => ({\r\n  type: SET_BORDERS,\r\n  payload\r\n})\r\n","import battle from '../assets/svg/legendIcons/battle.svg';\r\nimport troopMovement from '../assets/svg/legendIcons/troopMovement.svg';\r\nimport osada from '../assets/svg/legendIcons/osada.svg';\r\nimport city from '../assets/svg/legendIcons/city.svg';\r\nimport dote from '../assets/svg/legendIcons/dote.svg';\r\nimport dogovor from '../assets/svg/legendIcons/dogovor.svg';\r\n \r\nexport const eventTypes = [\r\n  { title: 'Битва', value: 'battle' },\r\n  { title: 'Осада', value: 'osada' },\r\n  { title: 'Передвижение войск', value: 'troopMovement' },\r\n  { title: 'HTML', value: 'html' },\r\n];\r\n\r\nexport const iconTypes = [\r\n  { title: 'Битва', value: 'battle' },\r\n  { title: 'Осада', value: 'osada' },\r\n  { title: 'Передвижение войск', value: 'troopMovement' },\r\n  { title: 'Договор', value: 'dogovor' },\r\n];\r\n\r\nexport const outcomeTypes = [\r\n  { title: 'Победа', value: 1 },\r\n  { title: 'Ничья', value: 0 },\r\n  { title: 'Поражение', value: -1 },\r\n]\r\n\r\nexport const eventIcons = {\r\n  osada,\r\n  battle,\r\n  troopMovement,\r\n  city,\r\n  dote,\r\n  dogovor,\r\n}\r\n\r\nexport const PAST_EVENTS = 'PAST_EVENTS';","import React, { useState, useEffect } from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './Legend.index';\r\nimport { connect } from 'react-redux';\r\nimport './Legend.scss';\r\nimport LegendImg from '../../assets/img/Legend.png';\r\nimport ArrowLeft from '../../assets/img/ArrowLeft.png';\r\nimport ArrowRight from '../../assets/img/ArrowRight.png';\r\nimport { ReactSVG } from 'react-svg';\r\nimport { eventIcons, PAST_EVENTS } from '../../utils/constants';\r\n// import Checkbox from '@material-ui/core/Checkbox';\r\n\r\nconst LegendPresenter = ({\r\n  legend,\r\n  excludedTypes,\r\n  exludeLegendType\r\n}) => {\r\n\r\n  const [open, setOpen] = useState(false);\r\n\r\n  return (\r\n    <div className={`Legend ${open && 'Legend-open'} ${!legend?.length && 'Legend-nodata'}`}>\r\n      <div className='Legend-Title'>\r\n        <img src={LegendImg} />\r\n        <span>Легенда</span>\r\n      </div>\r\n\r\n      <div className='Legend-Content'>\r\n\r\n        {!!legend && legend.map(legendGroup =>\r\n          <div>\r\n            {!!legendGroup.name && <div style={{ visibility: open ? 'visible' : 'hidden' }} className='Legend-Content-Group'>{legendGroup.name}</div>}\r\n            {legendGroup.items.map(item => (\r\n            <div className='Legend-Content-Item'>\r\n              <ReactSVG\r\n                className='Legend-Content-Item-Icon'\r\n                style={{ fill: excludedTypes.includes(item.value) ? '#787878' : item.iconColor }}\r\n                src={eventIcons[item.iconType]}\r\n                beforeInjection={(svg) => {\r\n                  svg.classList.add('svg-class-name')\r\n                  svg.setAttribute('style', 'width: 20px; height: 20px')\r\n                }}\r\n                onClick={() => exludeLegendType(item.value)}\r\n              />\r\n\r\n              <span>\r\n                {item.title}\r\n              </span>\r\n            </div>\r\n          ))}\r\n          </div>\r\n        )}\r\n\r\n        <div>\r\n        <div className='Legend-Content-Item checkbox'>\r\n          <input type='checkbox' checked={excludedTypes.includes(PAST_EVENTS)} onChange={() => exludeLegendType(PAST_EVENTS) } />\r\n          <span>Отображать прошедшие события</span>\r\n        </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div className='Legend-Toggle' onClick={() => setOpen(!open)}>\r\n        <img src={open ? ArrowRight : ArrowLeft} />\r\n        {open && <span>Свернуть</span>}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const Legend = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(LegendPresenter);","import { bindActionCreators } from 'redux';\r\nimport { exludeLegendType } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => {\r\n  return {\r\n    legend: state.map?.activeTheme?.legend,\r\n    excludedTypes: state.map.excludedTypes\r\n  }\r\n}\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  exludeLegendType\r\n}, dispatch);","\r\nexport const getImageSizeByZoom = (x, y, zoom) => [x * zoom * 0.5, y * zoom * 0.5];\r\n\r\nexport const getYearsArray = (yearStart, yearEnd) => {\r\n  return Array.from({length: yearEnd - yearStart + 1}, (_, i) => i + yearStart)\r\n}\r\n\r\nexport const getEventIconSize = (zoom) => {\r\n\r\n  switch (zoom) {\r\n    case 6:\r\n      return 25 + (zoom - 3)\r\n    case 7:\r\n      return 33 + (zoom - 3)\r\n    default:\r\n      return 15 + (zoom - 3);\r\n  }\r\n\r\n}","import L from \"leaflet\";\r\nimport \"leaflet-geometryutil\";\r\nimport * as turf from '@turf/turf'\r\nimport {toLatLng} from \"leaflet/src/geo/LatLng\";\r\n\r\nexport class LeafletThickArrowsDraw {\r\n\r\n    constructor(options) {\r\n        // Merge user input options with default options:\r\n        const defaults = {\r\n            arrow: {},\r\n            head: {\r\n                yawn: 60,\r\n                size: 10\r\n            },\r\n            weight: 1,\r\n            tailWidth: 400,\r\n            headWidth: 160,\r\n        };\r\n        this.precision = 10;\r\n        this.options = Object.assign({}, defaults, options);\r\n    }\r\n\r\n    draw(map, parts) {\r\n        let options = this.options;\r\n        let layers = [];\r\n\r\n        let kilometersPerPixel = this.getKilometersPerPixel(map);\r\n        const tailWidth = options.tailWidth * kilometersPerPixel * options.weight;\r\n        const headWidth = options.headWidth * kilometersPerPixel * options.weight;\r\n        parts.forEach((path, index) => {\r\n            if(path.length > 1) {\r\n                let latLngPath = [];\r\n                path.forEach((point) => latLngPath.push(map.layerPointToLatLng(point)));\r\n\r\n                // up and down - arrow body lines\r\n                let [angle, up, down] = this.calcArrowBody(map, latLngPath, tailWidth, headWidth);\r\n\r\n                // up = this.smoothLine(map, up, latLngPath);\r\n                // down = this.smoothLine(map, down, latLngPath);\r\n\r\n                // draw hat\r\n                const [hatPoints, leftWingPoint, rightWingPoint] = this.calcHatPoints(map, options, angle, latLngPath[latLngPath.length-1]);\r\n\r\n                // intersection points of hat and arrow\r\n                const hatCross = L.polyline([[leftWingPoint.lat, leftWingPoint.lng], [rightWingPoint.lat, rightWingPoint.lng]]);\r\n                let upIntersect = turf.intersect(hatCross.toGeoJSON(), L.polyline(up).toGeoJSON());\r\n                let downIntersect = turf.intersect(hatCross.toGeoJSON(), L.polyline(down).toGeoJSON());\r\n\r\n                // filter points inside hat\r\n                [up, upIntersect] = this.filterPointsInHat(up, upIntersect);\r\n                [down, downIntersect] = this.filterPointsInHat(down, downIntersect);\r\n\r\n                up.reverse()\r\n\r\n                let arrow = Array.prototype.concat(hatPoints, upIntersect, up, [up[up.length-1], down[0]], down, [down[down.length-1]], downIntersect);\r\n                layers.push(L.polygon(arrow, options.arrow));\r\n            }\r\n        });\r\n        return layers;\r\n    }\r\n\r\n    calcHatPoints(map, options, angle, tip) {\r\n        let sizePixels = options.head.size;\r\n        let bearing = 180.0 + angle;\r\n        let thetaLeft =\r\n            (180 - bearing - options.head.yawn / 2) * (Math.PI / 180),\r\n            thetaRight =\r\n                (180 - bearing + options.head.yawn / 2) * (Math.PI / 180);\r\n\r\n        let dxLeft = sizePixels * Math.sin(thetaLeft),\r\n            dyLeft = sizePixels * Math.cos(thetaLeft),\r\n            dxRight = sizePixels * Math.sin(thetaRight),\r\n            dyRight = sizePixels * Math.cos(thetaRight);\r\n\r\n        let derivedXY = map.latLngToLayerPoint(tip);\r\n        let leftWingXY = {\r\n            x: derivedXY.x + dxLeft,\r\n            y: derivedXY.y + dyLeft,\r\n        };\r\n        let rightWingXY = {\r\n            x: derivedXY.x + dxRight,\r\n            y: derivedXY.y + dyRight,\r\n        };\r\n\r\n        let leftWingPoint = map.layerPointToLatLng(leftWingXY),\r\n            rightWingPoint = map.layerPointToLatLng(rightWingXY);\r\n\r\n        let hatPoints = [\r\n            [leftWingPoint.lat, leftWingPoint.lng],\r\n            [tip.lat, tip.lng],\r\n            [rightWingPoint.lat, rightWingPoint.lng]\r\n        ];\r\n\r\n        return [hatPoints, leftWingPoint, rightWingPoint]\r\n    }\r\n\r\n    latLngToCoords(latLng) {\r\n        // return [lat, lng]. (!) native latLngToCoords return [lng, lat] (reversed)\r\n        return [L.Util.formatNum(latLng.lat, this.precision), L.Util.formatNum(latLng.lng, this.precision)];\r\n    }\r\n\r\n    filterPointsInHat(line, intersect) {\r\n        if (intersect) {\r\n            intersect = toLatLng(intersect.geometry.coordinates.reverse());\r\n            let latDirection = Math.sign(line[line.length - 1].lat - intersect.lat);\r\n            let lngDirection = Math.sign(line[line.length - 1].lng - intersect.lng);\r\n            line = line.filter((latLng) => (latLng.lat - intersect.lat) * latDirection < 0 || (latLng.lng - intersect.lng) * lngDirection < 0);\r\n        } else {\r\n            intersect = [];\r\n        }\r\n        return [line, intersect];\r\n    }\r\n\r\n    getKilometersPerPixel(map) {\r\n        const equatorLength = 40075.016686;\r\n        return equatorLength * Math.abs(Math.cos(map.getCenter().lat * Math.PI/180)) / Math.pow(2, map.getZoom()+8);\r\n    }\r\n\r\n    smoothLine(map, line, original) {\r\n        let prev;\r\n        line.forEach((latLng, index) => {\r\n            let current = map.latLngToLayerPoint(latLng, this.precision)\r\n            if(prev) {\r\n                let deltaX = Math.abs(prev.x - current.x);\r\n                let deltaY = Math.abs(prev.y - current.y);\r\n                if((deltaX > 0 && deltaY > 0) && (deltaX < 4 || deltaY < 4) && (deltaX/deltaY <= 0.2 || deltaY/deltaX <= 0.2)) {\r\n                    let newLatLng = map.layerPointToLatLng(new L.Point(current.x/2 + prev.x/2, current.y/2 + prev.y/2));\r\n                    line[index] = newLatLng;\r\n                }\r\n            }\r\n\r\n            prev = current;\r\n        });\r\n\r\n        return line;\r\n    }\r\n\r\n    calcArrowBody(map, latLngPath, tailWidth, headWidth) {\r\n        let angle;\r\n        let up = [];\r\n        let down = [];\r\n        let width = tailWidth;\r\n        let widthStep = (tailWidth - headWidth) / map.distance(latLngPath[0], latLngPath[latLngPath.length-1]);\r\n        let prevPart = latLngPath[0];\r\n        angle = L.GeometryUtil.angle(map, latLngPath[0], latLngPath[1]);\r\n        latLngPath.forEach((latLng, index) => {\r\n            if (index>0) {\r\n                angle = L.GeometryUtil.angle(map, latLngPath[index-1], latLngPath[index]);\r\n                width -= widthStep * map.distance(latLngPath[index-1], latLngPath[index])\r\n            }\r\n            let upPoint = L.GeometryUtil.destination(latLng, angle + 90, width)\r\n            up.push(upPoint);\r\n            down.push(L.GeometryUtil.destination(upPoint, angle - 90, width*2));\r\n            prevPart = latLng;\r\n        });\r\n\r\n        return [angle, up, down];\r\n    }\r\n}\r\n","import L from \"leaflet\";\r\nimport {LeafletThickArrowsDraw} from './leaflet-thickarrows-draw'\r\n\r\nlet saved_Polyline_addTo = L.Polyline.prototype.addTo;\r\nlet saved_Polyline__update = L.Polyline.prototype._update;\r\nlet saved_Polyline_remove = L.Polyline.prototype.remove;\r\n\r\nL.Polyline.include({\r\n    thickArrows: function (options = {}) {\r\n        this.options.noClip = true;\r\n        this._thickArrowsDraw = new LeafletThickArrowsDraw(options);\r\n        return this;\r\n    },\r\n\r\n    drawThickArrows: function () {\r\n        if (this._thickArrows) {\r\n            this._thickArrows.remove();\r\n        }\r\n\r\n        let layers = this._thickArrowsDraw.draw(this._map, this._parts);\r\n        this._thickArrows = L.layerGroup(layers);\r\n        return this;\r\n    },\r\n\r\n    getThickArrows: function () {\r\n        if (this._thickArrows) {\r\n            return this._thickArrows;\r\n        } else {\r\n            return console.log(\r\n                `Error: You tried to call '.getThickArrows() on a shape that does not have a thickArrows.  Use '.thickArrows()' to add a thickArrows before trying to call '.getThickArrows()'`\r\n            );\r\n        }\r\n    },\r\n\r\n    deleteThickArrows: function () {\r\n        if (this._thickArrows) {\r\n            this._thickArrows.remove();\r\n            delete this._thickArrows;\r\n            this._thickArrowsDraw = null;\r\n            delete this._thickArrowsDraw;\r\n        }\r\n    },\r\n\r\n    addTo: function (map) {\r\n        saved_Polyline_addTo.apply(this, arguments);\r\n        if (this._thickArrowsDraw) {\r\n            this.drawThickArrows();\r\n            this._thickArrows.addTo(this._map);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    _update: function () {\r\n        saved_Polyline__update.apply(this, arguments);\r\n        if (this._thickArrowsDraw) {\r\n            this.drawThickArrows();\r\n            this._map.addLayer(this._thickArrows);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    remove: function () {\r\n        if (this._thickArrows) {\r\n            this._thickArrows.remove();\r\n        }\r\n        saved_Polyline_remove.apply(this, arguments);\r\n        return this;\r\n    }\r\n});\r\n\r\nlet saved_LayerGroup_removeLayer = L.LayerGroup.prototype.removeLayer;\r\nlet saved_LayerGroup_onRemove = L.LayerGroup.prototype.onRemove;\r\n\r\nL.LayerGroup.include({\r\n    removeLayer: function (layer) {\r\n        var id = layer in this._layers ? layer : this.getLayerId(layer);\r\n\r\n        if (this._map && this._layers[id]) {\r\n            if (this._layers[id]._thickArrows) {\r\n                this._layers[id]._thickArrows.remove();\r\n            }\r\n        }\r\n\r\n        saved_LayerGroup_removeLayer.apply(this, arguments);\r\n        return this;\r\n    },\r\n\r\n    onRemove: function (map, layer) {\r\n        if (layer in this._layers) {\r\n            if (this._layers[layer]) {\r\n                this._layers[layer].remove();\r\n            }\r\n        }\r\n        saved_LayerGroup_onRemove.apply(this, arguments);\r\n    }\r\n});\r\n\r\nlet saved_Map_removeLayer = L.Map.prototype.removeLayer;\r\n\r\nL.Map.include({\r\n    removeLayer: function (layer) {\r\n        if (layer._thickArrows) {\r\n            layer._thickArrows.remove();\r\n        }\r\n\r\n        saved_Map_removeLayer.apply(this, arguments)\r\n        return this;\r\n    },\r\n});\r\n\r\nlet saved_GeoJSON_geometryToLayer = L.GeoJSON.geometryToLayer;\r\n\r\nL.GeoJSON.include({\r\n    geometryToLayer: function (geojson, options) {\r\n        const figure = saved_GeoJSON_geometryToLayer.apply(this, arguments);\r\n        const geometry = geojson.type === 'Feature' ? geojson.geometry : geojson;\r\n        if (!geometry || !figure) {\r\n            return figure;\r\n        }\r\n        switch (geometry.type) {\r\n            case 'LineString':\r\n            case 'MultiLineString':\r\n                if (options.thickArrows) {\r\n                    figure.thickArrows(options.thickArrows);\r\n                }\r\n        }\r\n        return figure;\r\n    },\r\n    addData: function (geojson) {\r\n        var features = L.Util.isArray(geojson) ? geojson : geojson.features,\r\n            i,\r\n            len,\r\n            feature;\r\n\r\n        if (features) {\r\n            for (i = 0, len = features.length; i < len; i++) {\r\n                // only add this if geometry or geometries are set and not null\r\n                feature = features[i];\r\n                if (\r\n                    feature.geometries ||\r\n                    feature.geometry ||\r\n                    feature.features ||\r\n                    feature.coordinates\r\n                ) {\r\n                    this.addData(feature);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n\r\n        var options = this.options;\r\n\r\n        if (options.filter && !options.filter(geojson)) {\r\n            return this;\r\n        }\r\n\r\n        var layer = this.geometryToLayer(geojson, options);\r\n        if (!layer) {\r\n            return this;\r\n        }\r\n        layer.feature = L.GeoJSON.asFeature(geojson);\r\n\r\n        layer.defaultOptions = layer.options;\r\n        this.resetStyle(layer);\r\n\r\n        if (options.onEachFeature) {\r\n            options.onEachFeature(geojson, layer);\r\n        }\r\n\r\n        return this.addLayer(layer);\r\n    }\r\n});\r\n","import React, { useState, useEffect } from 'react';\r\nimport hexToRgba from 'hex-to-rgba';\r\nimport { Map as LeafletMap, TileLayer, Marker, Tooltip, LayerGroup, GeoJSON, ImageOverlay } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport 'leaflet-arrowheads';\r\n\r\nimport { mapStateToProps, mapDispatchToProps } from './Map.index';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport { eventIcons, PAST_EVENTS } from '../../utils/constants';\r\nimport { getEventIconSize } from '../../utils/utils';\r\n\r\nimport './Map.scss';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { GeoJSONFillable, Patterns} from 'react-leaflet-geojson-patterns';\r\n\r\nimport '../../utils/arrows/leaflet-thickarrows';\r\n\r\n\r\nconst MapPresenter = ({\r\n  events,\r\n  setActiveEvent,\r\n  mapPosition,\r\n  mapZoom,\r\n  activeTheme,\r\n  setMapPosition,\r\n  setMapZoom,\r\n  excludedTypes,\r\n  setInfoblocks,\r\n  setInfoblockId,\r\n  cities,\r\n  dotes,\r\n  getDotes,\r\n  borders,\r\n  currentYear,\r\n}) => {\r\n\r\n  const [zoom, setZoom] = useState(4)\r\n\r\n  useEffect(() => {\r\n    if (activeTheme) {\r\n      setMapPosition(activeTheme.position);\r\n      setMapZoom(activeTheme.zoom || 4); \r\n    }\r\n  }, [activeTheme]);\r\n\r\n  useEffect(() => getDotes(), []);\r\n\r\n  const [showMove, setShowMove] = useState(true);\r\n  useEffect(() => {\r\n    setShowMove(() => false)\r\n  }, [currentYear, zoom]);\r\n  useEffect(() => {\r\n    if (!showMove) setShowMove(() => true)\r\n  } , [showMove])\r\n\r\n  const mapMinZoom = 3;\r\n  const mapMaxZoom = 7;\r\n  const crs = L.CRS.EPSG3857;\r\n\r\n  return (\r\n    <LeafletMap\r\n      maxBoundsViscosity={1}\r\n      worldCopyJump={false}\r\n      className='Map'\r\n      id='map'\r\n      maxBounds={[[85, -180], [85, 180], [-85, -180], [-85, 180]]}\r\n      scrollWheelZoom={false}\r\n      center={mapPosition}\r\n      zoom={mapZoom}\r\n      crs={crs}\r\n      maxZoom={mapMaxZoom}\r\n      minZoom={mapMinZoom}\r\n      zoomAnimation={true}\r\n      animate={true}\r\n      onzoomend={(e) => setZoom(e.target._zoom)}\r\n      onclick={e => console.log([e.latlng.lat, e.latlng.lng])}\r\n    >\r\n      <TileLayer\r\n        pane='tilePane'\r\n        noWrap={true}\r\n        minZoom={mapMinZoom}\r\n        maxZoom={mapMaxZoom}\r\n        tms={false}\r\n        url=\"https://schoolatlas.ru/img/tiles/{z}/{x}/{y}.png\"\r\n      />\r\n\r\n     \r\n\r\n      {(!!cities.length && zoom >= 5) && cities.map((city) => {\r\n\r\n        if (city.minShowZoom ? city.minShowZoom > zoom : false) return null;\r\n\r\n        const iconPerson = new L.Icon({\r\n          iconUrl: eventIcons['city'],\r\n          iconRetinaUrl: eventIcons['city'],\r\n          iconSize: 5 + (zoom - 3),\r\n        });\r\n\r\n        return ( \r\n          <Marker pane='markerPane' key={city._id} icon={iconPerson} position={city.position}>\r\n            <Tooltip className={'Map-Cities-Tooltip'} permanent={true} direction='top' >\r\n              <div>{city.title}</div>\r\n            </Tooltip>\r\n          </Marker>\r\n        )\r\n      })}\r\n\r\n      <LayerGroup pane='overlayPane' >\r\n        {(!!borders.length) && borders.map((border) => {\r\n          if ((!!excludedTypes && excludedTypes.includes(border.legendType))) return null;\r\n\r\n          const Component = border.stripe ? GeoJSONFillable : GeoJSON;\r\n          const styles = border.stripe ? (feature) => ({ fillPattern: Patterns.StripePattern({ weight: 10, spaceWeight: 20, fill: true, width: 20, height: 20, color: border.fillColor, key: border._id, spaceOpacity: 1, spaceColor: border.stripeColor || '#fff', angle: 45 })}) : undefined;\r\n          return <>\r\n            <Component   \r\n              \r\n              renderer={L.svg({ padding: 0.8 })}\r\n              smoothFactor={2}\r\n              weight={border.weight}\r\n              color={border.color}\r\n              opacity={border.opacity}\r\n              fillColor={border.fillColor}\r\n              fillOpacity={border.fillOpacity}\r\n              data={border.data}\r\n              key={border._id}\r\n              style={styles}\r\n            />\r\n            {border.imageUrl && border.bounds && <ImageOverlay\r\n              pane='markerPane'\r\n              url={border.imageUrl}\r\n              bounds={border.bounds}\r\n              key={`name-${border._id}`}\r\n              opacity={border.opacity || 1}\r\n            />}\r\n          </>\r\n        })}\r\n      </LayerGroup>\r\n\r\n\r\n      {!!events.length && events.map(el => {\r\n        const hideEvent = (\r\n          (!!excludedTypes && excludedTypes.includes(el.legendType)) ||\r\n          (el.minShowZoom ? el.minShowZoom > zoom : false)\r\n        );\r\n        if (hideEvent) return null;\r\n        const isCurrentEvent = el.yearStart <= currentYear && el.yearEnd >= currentYear;\r\n        if (!excludedTypes?.includes(PAST_EVENTS) && !isCurrentEvent) return null;\r\n        const cls = ['Map-Event'];\r\n        if (!isCurrentEvent) cls.push('Map-Event-Past');\r\n\r\n        if (el.type === 'troopMovement' && showMove) {\r\n          const size = `${5 +(Math.pow(zoom - 3, 2))}px`\r\n          return <GeoJSON \r\n          pane='popupPane' \r\n          smoothFactor={2} \r\n          className={cls.join(' ')}\r\n          key={el._id} data={el.data.data} \r\n          weight={-1 + zoom} \r\n          color={el.data.color} \r\n          style={{opacity: 0, zIndex: 9999}}\r\n          thickArrows={{arrow: {color: el.data.color, opacity: 0.3, fillColor: el.data.color, fillOpacity: isCurrentEvent ? 1 : 0.3, pane: 'markerPane' }, head: {size: 5 +(Math.pow(zoom - 3, 2)), yawn: 60}, weight: 5 +(Math.pow(zoom - 3, 2))}}\r\n          // thickArrows={{arrow: {color: el.data.color, fillColor: el.data.color, fillOpacity: 1}}}\r\n          >\r\n            <Tooltip direction='top' >\r\n              <div>{el.title}</div>\r\n            </Tooltip>\r\n          </GeoJSON>\r\n        }\r\n\r\n        const iconPerson = new L.Icon({\r\n          iconUrl: eventIcons[el.iconType],\r\n          iconRetinaUrl: eventIcons[el.iconType],\r\n          iconSize: getEventIconSize(zoom),\r\n          className: cls.join(' '),\r\n        });\r\n\r\n        return (\r\n          <Marker pane='tooltipPane' zIndexOffset style={{opacity: 0.3, zIndex: 99}} onclick={() => {\r\n            setInfoblocks(el);\r\n            setInfoblockId(el._id);\r\n          }} key={el._id} icon={iconPerson} position={el.position}>\r\n            <Tooltip pane='popupPane' direction='top' >\r\n              <div>{el.title}</div>\r\n            </Tooltip>\r\n          </Marker>\r\n        )\r\n      })}\r\n\r\n    </LeafletMap>\r\n  )\r\n}\r\n\r\nexport const Map = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(MapPresenter);","import { bindActionCreators } from 'redux';\r\nimport { setActiveEvent, setMapPosition, setMapZoom, setInfoblocks, setInfoblockId, getDotes } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => ({\r\n  events: state.map.events,\r\n  mapPosition: state.map.mapPosition,\r\n  mapZoom: state.map.mapZoom,\r\n  activeTheme: state.map.activeTheme,\r\n  excludedTypes: state.map.excludedTypes,\r\n  cities: state.map.cities,\r\n  dotes: state.map.dotes,\r\n  borders: state.map.borders,\r\n  infoblockId: state.map.infoblockId,\r\n  currentYear: state.map.currentYear\r\n})\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  setActiveEvent,\r\n  setMapPosition,\r\n  setMapZoom,\r\n  setInfoblocks,\r\n  setInfoblockId,\r\n  getDotes\r\n}, dispatch);\r\n","import React, { useState, useEffect } from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './Search,index';\r\nimport './Search.scss';\r\nimport { connect } from 'react-redux';\r\nimport SearchImg from '../../assets/svg/search.svg';\r\nimport { useDebouncedCallback } from 'use-debounce';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nconst SearchPresenter = ({\r\n  search,\r\n  data,\r\n  loading,\r\n  showSearch,\r\n  setSearch,\r\n  getThemes,\r\n  getEvents,\r\n  setThemesLoading,\r\n  setActiveTheme,\r\n  setInfoblocks,\r\n  setInfoblockId,\r\n  clearInfoblockData\r\n}) => {\r\n\r\n  const history = useHistory();\r\n\r\n  const getData = useDebouncedCallback(getThemes, 1000);\r\n\r\n  const onChangeSearch = (e) => {\r\n    !!e.target.value && setThemesLoading(true)\r\n    setSearch(e.target.value);\r\n    getData.callback(e.target.value);\r\n  }\r\n\r\n  const onSelectTheme = item => {\r\n    clearInfoblockData();\r\n    setSearch(item.title);\r\n    setActiveTheme(item);\r\n    setInfoblocks(item);\r\n    let params = new URLSearchParams();\r\n    params.append(\"themeId\", item._id);\r\n    history.push({ search: params.toString() });\r\n  }\r\n\r\n  return (\r\n    <div className={`Search ${showSearch && !!search && 'active'}`}>\r\n      <img src={SearchImg} className='Search-Btn' />\r\n      <input\r\n        placeholder='Поиск по атласу'\r\n        value={search}\r\n        onChange={onChangeSearch}\r\n      />\r\n\r\n      {showSearch && !!search &&\r\n      <div className='Search-Results'>\r\n        {loading ? <div className='Search-Results-Item'>Загрузка...</div> :\r\n        data.length ? data.map(item => (\r\n          <div onClick={() => onSelectTheme(item)} key={item.id} className='Search-Results-Item'>\r\n            <div>{item.title}</div>\r\n            <div>\r\n              {item?.yearStart}\r\n              {!!item.yearEnd && ` - ${item.yearEnd}`}\r\n            </div>\r\n          </div>\r\n        )) :\r\n        <div className='Search-Results-Item'>Ничего не найдено</div>\r\n        }\r\n      </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const Search = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(SearchPresenter)\r\n\r\n","import { bindActionCreators } from 'redux';\r\nimport { setSearch, getThemes, getEvents, setThemesLoading, setActiveTheme, setInfoblocks, setInfoblockId, clearInfoblockData } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => {\r\n  return {\r\n    search: state.map.search,\r\n    data: state.map.data,\r\n    loading: state.map.themesLoading,\r\n    showSearch: state.map.showSearch\r\n  }\r\n}\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  setSearch,\r\n  getThemes,\r\n  getEvents,\r\n  setThemesLoading,\r\n  setActiveTheme,\r\n  setInfoblocks,\r\n  setInfoblockId,\r\n  clearInfoblockData\r\n}, dispatch);","import React, { useState, useEffect, useRef } from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './YearsNavigation.index';\r\nimport { connect } from 'react-redux';\r\nimport { getYearsArray } from '../../utils/utils';\r\nimport arrowLeft from '../../assets/img/ArrowLeft.png';\r\nimport arrowRight from '../../assets/img/ArrowRight.png';\r\nimport './YearsNavigation.scss';\r\n\r\n\r\nconst YearsNavigationPresenter = ({\r\n  activeTheme,\r\n  getEvents,\r\n  setCurrentYear,\r\n  currentYear,\r\n  getCities,\r\n  getBorders\r\n}) => {\r\n\r\n  const scrollBlock = useRef();\r\n\r\n  const [containerWidth, setConteinerWidth] = useState(0);\r\n  const [itemWidth, setItemWidth] = useState(0);\r\n  const [itemsCount, setItemsCount] = useState(0);\r\n  const [years, setYears] = useState([]);\r\n\r\n  const [windowWidth, setWindowWidth] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => setWindowWidth(window.innerWidth);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    setYears(activeTheme ? getYearsArray(activeTheme.yearStart, activeTheme.yearEnd) : getYearsArray(2000, 2020));\r\n  }, [activeTheme])\r\n\r\n  useEffect(() => {\r\n    activeTheme && getEvents({ themeId: activeTheme._id, currentYear });\r\n  }, [activeTheme, currentYear]);\r\n\r\n  useEffect(() => {\r\n    if (scrollBlock) {\r\n      setConteinerWidth(scrollBlock.current.clientWidth);\r\n    }\r\n  }, [scrollBlock.current?.clientWidth]);\r\n\r\n  useEffect(() => {\r\n    if (currentYear) {\r\n      getCities(currentYear);\r\n      getBorders(currentYear);\r\n    }\r\n  }, [currentYear])\r\n\r\n  useEffect(() => {\r\n    if (containerWidth >= 1100 && years.length >= 15) setItemsCount(15);\r\n    else if (containerWidth >= 1100 && years.length < 15) setItemsCount(years.length);\r\n\r\n    else if (containerWidth < 1100 && containerWidth >= 700) setItemsCount(10);\r\n    else if (containerWidth < 1100 && containerWidth >= 700 && years.length < 10) setItemsCount(years.length);\r\n\r\n    else if (containerWidth < 700) setItemsCount(5);\r\n    else if (containerWidth < 700 && years.length < 5) setItemsCount(years.length);\r\n\r\n  }, [containerWidth, activeTheme, years])\r\n\r\n  useEffect(() => {\r\n    setItemWidth(scrollBlock.current.clientWidth / itemsCount);\r\n  }, [itemsCount])\r\n\r\n  useEffect(() => {\r\n    if (years.includes(new Date().getFullYear())) {\r\n      const timeoutId = setTimeout(() => onScroll(10000), 0);\r\n      return () =>  clearTimeout(timeoutId);\r\n    }\r\n    else {\r\n      scrollBlock.current.scrollLeft = 0;\r\n      console.log('else');\r\n    }\r\n  }, [years, activeTheme])\r\n\r\n  const onScroll = (scroll) => {\r\n    scrollBlock.current.scrollLeft += scroll;\r\n  }\r\n\r\n  const onSetCurrentYear = (year) => {\r\n    setCurrentYear(year);\r\n    \r\n  }\r\n\r\n  return (\r\n    <div className='YearsNavigation'>\r\n      <div style={{width: `${containerWidth + 20}px`}} className='YearsNavigation-Line' />\r\n\r\n      <img onClick={() => onScroll(-containerWidth)} className='YearsNavigation-Left' src={arrowLeft} />\r\n      \r\n      <div ref={scrollBlock} className='YearsNavigation-Wrapper'>\r\n        \r\n        {years.map((year, idx) => {\r\n          return (\r\n            <div style={{minWidth: `${itemWidth}px`}} className='YearsNavigation-Item'>\r\n              <div onClick={() => onSetCurrentYear(year)} key={`circle-${year}`} className={`YearsNavigation-Item-Circle ${currentYear === year ? 'active' : ''}`}>\r\n                <div className='YearsNavigation-Item-Year' key={`year-${year}`}>\r\n                  {year}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n\r\n      <img onClick={() => onScroll(containerWidth)} className='YearsNavigation-Right' src={arrowRight} />\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const YearsNavigation = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(YearsNavigationPresenter);","import { bindActionCreators } from 'redux';\r\nimport { getEvents, setCurrentYear, getCities, getBorders } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => {\r\n  return {\r\n    activeTheme: state.map.activeTheme,\r\n    currentYear: state.map.currentYear\r\n  }\r\n}\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  getEvents,\r\n  setCurrentYear,\r\n  getCities,\r\n  getBorders\r\n}, dispatch);","import React from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './BattleOsada.index';\r\nimport { outcomeTypes } from '../../../utils/constants';\r\nimport { connect } from 'react-redux';\r\nimport './BattleOsada.scss';\r\n\r\nconst BattleOsadaPresenter = ({ data }) => {\r\n\r\n  const [f, s] = data.data;\r\n\r\n  const getOutcomeColor = (outcomeType) => {\r\n    if (outcomeType === '1') return 'color-green';\r\n    if (outcomeType === '0') return 'color-gray';\r\n    if (outcomeType === '-1') return 'color-red';\r\n  }\r\n\r\n  const isAllyExists = f.allyName && s.allyName;\r\n\r\n  return (\r\n    <div className='event'>\r\n      <div className='title mb-xl text-center'>\r\n        <span className='text-xl'>\r\n          {data.title}\r\n      </span>\r\n        <br />\r\n        <span className=\"color-red text-m\">\r\n          {data.date}\r\n      </span>\r\n      </div>\r\n\r\n      <div className='content'>\r\n\r\n        <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <img className=\"img-h-s mb-m\" src={f.opponentImgUrl} />\r\n            <span className=\"text-s text-center\">{f.opponentName}</span>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-center item-v-center\">Противники</div>\r\n          <div className=\"event-block-right\">\r\n            <img className=\"img-h-s mb-m\" src={s.opponentImgUrl} />\r\n            <span className=\"text-s text-center\">{s.opponentName}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {isAllyExists && <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <img className=\"img-h-s mb-m\" src={f.allyImgUrl} />\r\n            <span className=\"text-s text-center\">{f.allyName}</span>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-center item-v-center\">Союзники</div>\r\n          <div className=\"event-block-right\">\r\n            <img className=\"img-h-s mb-m\" src={s.allyImgUrl} />\r\n            <span className=\"text-s text-center\">{s.allyName}</span>\r\n          </div>\r\n        </div>}\r\n\r\n        <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <img className=\"img-s mb-m\" src={f.commanderImgUrl} />\r\n            <span className=\"text-s text-center\">{f.commanderName}</span>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-center item-v-center\">Главно&shy;командующие</div>\r\n          <div className=\"event-block-right\">\r\n            <img className=\"img-s  mb-m\" src={s.commanderImgUrl} />\r\n            <span className=\"text-s text-center\">{s.commanderName}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <div className=\"text-s mb-s text-center\">{f.strength}</div>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-cente item-v-center\">Силы сторон</div>\r\n          <div className=\"event-block-right\">\r\n            <div className=\"text-s mb-s\" >{s.strength}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <div className=\"text-s text-center\">{f.losses}</div>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-center item-v-center\">Потери</div>\r\n          <div className=\"event-block-right\">\r\n            <div className=\"text-s text-center\">{s.losses}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"event-block\">\r\n          <div className=\"event-block-left\">\r\n            <span className={`text-m text-center ${getOutcomeColor(f.outcome.toString())}`}>{outcomeTypes.find(el => el.value.toString() === f.outcome.toString())?.title}</span>\r\n          </div>\r\n          <div className=\"event-block-center text-l text-center item-v-center\">Итоги битвы</div>\r\n          <div className={`event-block-right text-center ${getOutcomeColor(s.outcome.toString())}`}>\r\n            <span className=\"text-m\">{outcomeTypes.find(el => el.value.toString() === s.outcome.toString())?.title}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport const BattleOsada = connect(mapStateToProps, mapDispatchToProps)(BattleOsadaPresenter);\r\n","import { bindActionCreators } from 'redux';\r\n\r\nexport const mapStateToProps = (state) => ({\r\n  data: state.map.infoblocks[state.map.infoblockId]\r\n})\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  \r\n}, dispatch);","import React from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './Html.index';\r\nimport { outcomeTypes } from '../../../utils/constants';\r\nimport { connect } from 'react-redux';\r\nimport './Html.scss';\r\n\r\nconst HtmlPresenter = ({ data }) => {\r\n\r\n  return (\r\n    <div className='event'>\r\n      <div className='title mb-xl text-center'>\r\n        <span className='text-xl'>\r\n          {data.title}\r\n      </span>\r\n        <br />\r\n        <span className=\"color-red text-m\">\r\n          {data.date}\r\n      </span>\r\n      </div>\r\n\r\n      <div dangerouslySetInnerHTML={{ __html: data.data }} className='content'/>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport const Html = connect(mapStateToProps, mapDispatchToProps)(HtmlPresenter);\r\n","import { bindActionCreators } from 'redux';\r\n\r\nexport const mapStateToProps = (state) => ({\r\n  data: state.map.infoblocks[state.map.infoblockId]\r\n})\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  \r\n}, dispatch);","import React from'react'\r\nimport { BattleOsada } from './BattleOsada/BattleOsada';\r\nimport { Html } from './Html/Html';\r\n\r\nexport const infoblockToggler = {\r\n  osada: <BattleOsada />,\r\n  battle: <BattleOsada />,\r\n  html: <Html />,\r\n}","import React, { useRef, useEffect } from 'react';\r\nimport { mapStateToProps, mapDispatchToProps } from './Infoblock.index';\r\nimport { connect } from 'react-redux';\r\nimport { infoblockToggler } from './InfoblockToggler';\r\nimport './Infoblock.scss';\r\nimport './events.scss';\r\nimport './events-screens.scss';\r\n\r\nconst InfoblockPresenter = ({\r\n  events,\r\n  activeEvent,\r\n  setActiveEvent,\r\n  activeTheme,\r\n  infoblocksIds,\r\n  infoblocks,\r\n  setInfoblockId,\r\n  infoblockId,\r\n  closeInfoblock,\r\n}) => {\r\n\r\n  const scrollBlock = useRef();\r\n\r\n  useEffect(() => {\r\n    if (scrollBlock.current) scrollBlock.current.scrollLeft += 300;\r\n  }, [infoblocksIds])\r\n\r\n  if (!infoblockId) return null;\r\n\r\n  return (\r\n    <div className='Infoblock'>\r\n      <div ref={scrollBlock} className='Infoblock-Tabs'>\r\n        {infoblocksIds.map((id, idx) => (\r\n          <div style={{ zIndex: 99 - idx }} className={`Infoblock-Tabs-Item ${infoblockId === infoblocks[id]._id ? 'active' : ''}`} onClick={() => setInfoblockId(id)}>\r\n            <div className='Infoblock-Tabs-Item-Title' >{infoblocks[id].title}</div>\r\n            {idx > 0 && <div\r\n              className='Infoblock-Tabs-Item-Close'\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                const prevId = infoblocksIds[idx - 1] || infoblocksIds[1];\r\n                if (id === infoblockId) setInfoblockId(prevId);\r\n                closeInfoblock(id);\r\n              }}>\r\n              x\r\n            </div>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      \r\n      <div className='Infoblock-Content' id='infoblock'>\r\n        {infoblockToggler[infoblocks[infoblockId].type]}\r\n        {/* <div dangerouslySetInnerHTML={{ __html: infoblocks[infoblockId].description }} /> : */}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const Infoblock = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(InfoblockPresenter);\r\n","import { bindActionCreators } from 'redux';\r\nimport { setActiveEvent, setInfoblockId, closeInfoblock } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => {\r\n  return {\r\n    events: state.map.events,\r\n    activeEvent: state.map.activeEvent,\r\n    activeTheme: state.map.activeTheme,\r\n    infoblocks: state.map.infoblocks,\r\n    infoblocksIds: state.map.infoblocksIds,\r\n    infoblockId: state.map.infoblockId\r\n  }\r\n}\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  setActiveEvent,\r\n  setInfoblockId,\r\n  closeInfoblock,\r\n}, dispatch);","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Map, Legend, Search, YearsNavigation, Infoblock } from '../../components';\r\nimport { animateScroll } from 'react-scroll';\r\nimport { mapStateToProps, mapDispatchToProps } from './MapPage.index';\r\nimport { connect } from 'react-redux';\r\nimport queryString from 'query-string';\r\nimport { useLocation } from 'react-router-dom';\r\nimport './MapPage.scss';\r\n\r\nconst MapPagePresenter = ({ infoblockId, initMap }) => {\r\n\r\n  let location = useLocation();\r\n\r\n  useEffect(() => {\r\n    // for mobile browsers\r\n    const vh = window.innerHeight * 0.01;\r\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\r\n    const handleResize = () => {\r\n      const vh = window.innerHeight * 0.01;\r\n      document.documentElement.style.setProperty('--vh', `${vh}px`);\r\n    }\r\n    window.addEventListener('resize', handleResize);\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    initMap(queryString.parse(location.search));\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (infoblockId) animateScroll.scrollTo(820); // map height\r\n  }, [infoblockId])\r\n\r\n  return (\r\n    <div className='MapPage'>\r\n      <div className='MapPage-Map'>\r\n        <Search />\r\n        <Map />\r\n        <Legend />\r\n      </div>\r\n      <div className='MapPage-YearsNavigation'>\r\n        <YearsNavigation />\r\n      </div>\r\n      <div className='MapPage-Infoblock'>\r\n        <Infoblock />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const MapPage = connect\r\n  (mapStateToProps, mapDispatchToProps)(MapPagePresenter)\r\n","import { bindActionCreators } from 'redux';\r\nimport { initMap } from '../../redux/map/actions';\r\n\r\nexport const mapStateToProps = (state) => ({\r\n  infoblockId: state.map.infoblockId\r\n})\r\n\r\nexport const mapDispatchToProps = (dispatch) => bindActionCreators({\r\n  initMap\r\n}, dispatch);","import React from 'react';\r\nimport { MapPage } from './pages/MapPage/MapPage';\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport { ToastContainer } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      {/* ROUTING */}\r\n      <Switch>\r\n        <Route path='/' >\r\n          <MapPage />\r\n        </Route>\r\n\r\n      </Switch>\r\n\r\n\r\n      <ToastContainer />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import {\r\n  SET_SEARCH,\r\n  SET_THEMES,\r\n  SET_ACTIVE_THEME,\r\n  SET_EVENTS,\r\n  SET_THEMES_LOADING,\r\n  SET_SHOW_SEARCH,\r\n  SET_CURRENT_YEAR,\r\n  SET_ACTIVE_EVENT,\r\n  SET_MAP_POSITION,\r\n  SET_MAP_ZOOM,\r\n  LEGEND_EXLUDE_TYPE,\r\n  SET_INFOBLOCKS,\r\n  SET_INFOBLOCK_ID,\r\n  CLOSE_INFOBLOCK,\r\n  CLEAR_INFOBLOCK_DATA,\r\n  SET_CITIES,\r\n  SET_DOTES,\r\n  SET_BORDERS\r\n} from './actions';\r\n\r\nconst baseState = {\r\n  search: '',\r\n  showSearch: false,\r\n  data: [],\r\n  activeTheme: null,\r\n  events: [],\r\n  activeEvent: {},\r\n  themesLoading: false,\r\n  currentYear: new Date().getFullYear(),\r\n  mapZoom: 3,\r\n  mapPosition: [51.505, -0.09],\r\n  excludedTypes: [],\r\n  infoblocks: {},\r\n  infoblocksIds: [],\r\n  infoblockId: '',\r\n  cities: [],\r\n  dotes: [],\r\n  borders: [],\r\n}\r\n\r\nexport const mapReducer = (state = baseState, action) => {\r\n  switch (action.type) {\r\n\r\n    case SET_SEARCH: {\r\n      return {\r\n        ...state,\r\n        search: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_SHOW_SEARCH: {\r\n      return {\r\n        ...state,\r\n        showSearch: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_THEMES: {\r\n      return {\r\n        ...state,\r\n        data: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_ACTIVE_THEME: {\r\n      return {\r\n        ...state,\r\n        activeTheme: action.payload,\r\n        currentYear: action.payload.yearStart,\r\n        excludedTypes: []\r\n      }\r\n    }\r\n\r\n    case SET_THEMES_LOADING: {\r\n      return {\r\n        ...state,\r\n        themesLoading: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_EVENTS: {\r\n      return {\r\n        ...state,\r\n        events: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_ACTIVE_EVENT: {\r\n      return {\r\n        ...state,\r\n        activeEvent: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_CURRENT_YEAR: {\r\n      return {\r\n        ...state,\r\n        currentYear: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_MAP_POSITION: {\r\n      return {\r\n        ...state,\r\n        mapPosition: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_MAP_ZOOM: {\r\n      return {\r\n        ...state,\r\n        mapZoom: action.payload\r\n      }\r\n    }\r\n\r\n    case LEGEND_EXLUDE_TYPE: {\r\n      return {\r\n        ...state,\r\n        excludedTypes: state.excludedTypes.includes(action.payload) ? \r\n        state.excludedTypes.filter(type => type !== action.payload) :\r\n        [...state.excludedTypes, action.payload]\r\n      }\r\n    }\r\n\r\n    case SET_INFOBLOCKS: {\r\n      return {\r\n        ...state,\r\n        infoblocks: {\r\n          ...state.infoblocks, \r\n          [action.payload._id]: action.payload\r\n        },\r\n        infoblocksIds: state.infoblocksIds.includes(action.payload._id) ? state.infoblocksIds : [...state.infoblocksIds, action.payload._id]\r\n      } \r\n    }\r\n\r\n    case SET_INFOBLOCK_ID: {\r\n      return {\r\n        ...state,\r\n        infoblockId: action.payload\r\n      }\r\n    }\r\n\r\n    case CLOSE_INFOBLOCK: {\r\n      return {\r\n        ...state,\r\n        infoblocksIds: state.infoblocksIds.filter(id => id !== action.payload)\r\n      }\r\n    }\r\n\r\n    case CLEAR_INFOBLOCK_DATA: {\r\n      return {\r\n        ...state,\r\n        infoblocks: baseState.infoblocks,\r\n        infoblocksIds: baseState.infoblocksIds,\r\n        infoblockId: baseState.infoblockId\r\n      }\r\n    }\r\n\r\n    case SET_CITIES: {\r\n      return {\r\n        ...state,\r\n        cities: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_DOTES: {\r\n      return {\r\n        ...state,\r\n        dotes: action.payload\r\n      }\r\n    }\r\n\r\n    case SET_BORDERS: {\r\n      return {\r\n        ...state,\r\n        borders: action.payload\r\n      }\r\n    }\r\n   \r\n    default:\r\n      return state;\r\n  }\r\n} ","import { combineReducers } from 'redux';\r\nimport { mapReducer as map } from './map/reducer';\r\n\r\nexport const rootReducer = combineReducers({\r\n  map,\r\n});","import axios from 'axios';\r\n\r\nexport const getThemes = (search) => axios.get(`/api/themes`, {params: {search}});\r\n\r\nexport const getThemeById = (id) => axios.get('/api/themes/byId', { params: { id } });\r\n\r\nexport const getEvents = (themeId, currentYear) => axios.get('/api/events', {params: {themeId, currentYear}});\r\n\r\nexport const getCities = (year) => axios.get(`/api/cities/${year}`, {params: {}});\r\n\r\nexport const getDotesRequest = () => axios.get(`/api/dotes`, {params: {}});\r\n\r\nexport const getBorders = (year) => axios.get(`/api/borders/${year}`, {params: {}});\r\n","import { takeLatest, takeLeading, call, put } from 'redux-saga/effects';\r\nimport { \r\n  GET_THEMES, \r\n  setThemes, \r\n  GET_EVENTS, \r\n  setEvents, \r\n  setThemesLoading, \r\n  setShowSearch, \r\n  GET_CITIES, \r\n  setCities, \r\n  GET_DOTES, \r\n  setDotes,\r\n  GET_BORDERS,\r\n  setBorders,\r\n\r\n  INIT_MAP,\r\n  clearInfoblockData,\r\n  setSearch,\r\n  setActiveTheme,\r\n  setInfoblocks\r\n} from './actions';\r\nimport { getThemes, getEvents, getCities, getDotesRequest, getBorders, getThemeById } from '../../utils/requests/map.api';\r\n\r\nfunction* getThemesSaga(action) {\r\n  try {\r\n    yield put(setShowSearch(true));\r\n    const response = yield call(getThemes, action.payload);\r\n    yield put(setThemes(response.data));\r\n    yield put(setThemesLoading(false));\r\n  } catch (e) {\r\n    console.error('get search data error ',e);\r\n  }\r\n}\r\n\r\nfunction* getEventsSaga(action) {\r\n  try {\r\n    const { themeId, currentYear } = action.payload;\r\n    const response = yield call(getEvents, themeId, currentYear);\r\n    yield put(setEvents(response.data));\r\n    yield put(setShowSearch(false));\r\n  } catch (e) {\r\n    console.error(`get events b theme id <${action.payload}> error ${e}`);\r\n  }\r\n}\r\n\r\nfunction* getCitiesSaga(action) {\r\n  try {\r\n    const response = yield call(getCities, action.payload);\r\n    yield put(setCities(response.data));\r\n  } catch (e) {\r\n    console.error('get cities error', e);\r\n  }\r\n}\r\n\r\nfunction* getDotesSaga() {\r\n  try {\r\n    const response = yield call(getDotesRequest);\r\n    yield put(setDotes(response.data));\r\n  } catch (e) {\r\n    console.error('get cities error', e);\r\n  }\r\n}\r\n\r\nfunction* getBordersSaga(action) {\r\n  try {\r\n    const response = yield call(getBorders, action.payload);\r\n    yield put(setBorders(response.data));\r\n  } catch (e) {\r\n    console.error('get cities error', e);\r\n  }\r\n}\r\n\r\nfunction* initMapSaga(action) {\r\n  try {\r\n    yield put(clearInfoblockData()); // мб не надо???\r\n    const { themeId } = action.payload;\r\n    if (themeId) {\r\n      const response = yield call(getThemeById, themeId);\r\n      yield put(setSearch(response.data.title));\r\n      yield put(setActiveTheme(response.data));\r\n      yield put(setInfoblocks(response.data))\r\n    }\r\n    \r\n  \r\n\r\n  //   clearInfoblockData,\r\n  // setSearch,\r\n  // setActiveTheme,\r\n  // setInfoblocks\r\n\r\n  } catch (e) {\r\n    console.error('init map error');\r\n  }\r\n}\r\n\r\nconst map = function* () {\r\n  yield takeLatest(GET_THEMES, getThemesSaga);\r\n  yield takeLeading(GET_EVENTS, getEventsSaga);\r\n  yield takeLatest(GET_CITIES, getCitiesSaga);\r\n  yield takeLeading(GET_DOTES, getDotesSaga);\r\n  yield takeLatest(GET_BORDERS, getBordersSaga);\r\n  yield takeLeading(INIT_MAP, initMapSaga);\r\n}\r\n\r\nexport default map;","import { all } from 'redux-saga/effects';\r\nimport map from './map/saga';\r\n\r\nfunction* rootSaga() {\r\n  yield all([\r\n    map(),\r\n  ])\r\n}\r\n\r\nexport default rootSaga;","import { applyMiddleware, compose, createStore } from 'redux';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport {rootReducer} from './rootReducer.js';\r\nimport rootSaga from './sagas';\r\n\r\nconst sagaWiddleware = createSagaMiddleware();\r\n\r\nexport const store = createStore(\r\n  rootReducer,\r\n  compose(\r\n    applyMiddleware(\r\n      sagaWiddleware\r\n    ),\r\n    // window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n  )\r\n)\r\n\r\nsagaWiddleware.run(rootSaga);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\nimport './global.scss';\n\nimport { Provider } from 'react-redux';\nimport { store } from './redux/configureStore';\n\nimport { BrowserRouter } from \"react-router-dom\";\nimport { createBrowserHistory } from 'history';\n\nconst history = createBrowserHistory();\n\nReactDOM.render(\n  <Provider store={store}>\n    <BrowserRouter history={history}>\n      <App />\n    </BrowserRouter>\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACoSURBVHgBlZLtCYQwDIYT4f47yq1wP4+b4kZwAnsTyE0gTiE4hSM4ggvYmIj4gW1MXyiE8jyUNAEw5N+0pRyp0QITgZOaiAq0wpyB6xemwMX3PWAKHOxBgy/CHXwSLPAmWOFFSIElmffHPjAH8DkoWeCqbh0ilOvVSDTxK58+KqRIp2+1SJfB3UnB1dCk6PLFJHW9Q1KmCTxAx4P87TcPMEVequruKfUMnSOkCQuHD6sAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACwSURBVHgBlZPRDcIgEIbvrwt0hI7gGp3COIE6ge0ExAkaN/DJJr64ipOAdyQ1YoU7/qSFS77vgBCIOJfrfJaPDIGb7kcALhag4bDrx5LQMHbj8SVFCDRoK0F+bpo77v7kaaethGVilfBdWCT8dtCklaBJf4WSlBVyUkPFbFrG2qXyXpxs98cW8Nw9RIEvdTzt+wE1cNxWDbwSNDgRLPBHsMJRqIElyT1ocHJYeXlkyBt8S3tsW41jAQAAAABJRU5ErkJggg==\""],"sourceRoot":""}